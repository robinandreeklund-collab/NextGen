functions:
  # Sprint 1 – Kärnsystem
  data_ingestion:
    description: Hämtar trending symboler och öppnar WebSocket-strömmar från Finnhub
    inputs: [api_key, symbol_filters]
    outputs: [market_data]
    publishes: [market_data]
    subscribes: []
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  indicator_registry:
    description: Hämtar och distribuerar tekniska, fundamentala och alternativa indikatorer
    inputs: [symbol, timeframe]
    outputs: [indicator_data]
    publishes: [indicator_data]
    subscribes: []
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  strategy_engine:
    description: Genererar tradeförslag baserat på indikatorer, portföljstatus och RL-belöning
    inputs: [indicator_data, portfolio_status]
    outputs: [trade_proposal]
    publishes: [trade_proposal]
    subscribes: [indicator_data, portfolio_status]
    uses_rl: true
    receives_feedback: true
    has_adaptive_parameters: true

  decision_engine:
    description: Samlar insikter från strategi, risk och minne för att fatta beslut
    inputs: [trade_proposal, risk_profile, memory_insights]
    outputs: [decision_vote]
    publishes: [decision_vote]
    subscribes: [trade_proposal, risk_profile, memory_insights]
    uses_rl: true
    receives_feedback: true
    has_adaptive_parameters: true

  execution_engine:
    description: Exekverar eller simulerar trade och loggar resultat
    inputs: [final_decision]
    outputs: [execution_result, trade_log]
    publishes: [execution_result, trade_log]
    subscribes: [final_decision]
    uses_rl: true
    receives_feedback: true
    has_adaptive_parameters: true

  portfolio_manager:
    description: Uppdaterar portfölj, beräknar reward och returnerar kapitalstatus
    inputs: [execution_result]
    outputs: [portfolio_status, reward]
    publishes: [portfolio_status, reward]
    subscribes: [execution_result]
    uses_rl: false
    receives_feedback: true
    has_adaptive_parameters: false

  # Sprint 2 – RL och belöning
  rl_controller:
    description: Tränar PPO-agenter och justerar även meta-parametrar och modulinställningar
    inputs: [reward, feedback_event]
    outputs: [agent_update, agent_status, parameter_adjustment]
    publishes: [agent_update, agent_status, parameter_adjustment]
    subscribes: [reward, feedback_event]
    uses_rl: true
    receives_feedback: false
    has_adaptive_parameters: true

  risk_manager:
    description: Bedömer risknivå baserat på volatilitet, ESG och fundamentala indikatorer
    inputs: [indicator_data, portfolio_status]
    outputs: [risk_profile]
    publishes: [risk_profile]
    subscribes: [indicator_data, portfolio_status]
    uses_rl: true
    receives_feedback: true
    has_adaptive_parameters: true

  # Sprint 3 – Feedback och introspektion
  message_bus:
    description: Dirigerar meddelanden mellan moduler med loggning och spårbarhet
    inputs: [message]
    outputs: [routed_message]
    publishes: [routed_message]
    subscribes: [message]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  feedback_router:
    description: Distribuerar feedback mellan moduler
    inputs: [feedback_event]
    outputs: [feedback_event]
    publishes: [feedback_event]
    subscribes: [execution_result, portfolio_status]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  feedback_analyzer:
    description: Identifierar mönster i feedbackflöden och föreslår förbättringar
    inputs: [feedback_event]
    outputs: [feedback_insight]
    publishes: [feedback_insight]
    subscribes: [feedback_event]
    uses_rl: false
    receives_feedback: true
    has_adaptive_parameters: false

  introspection_panel:
    description: Visualiserar modulstatus, RL-performance, parameterjusteringar och kommunikation
    inputs: [agent_status, feedback_event, indicator_data, parameter_adjustment]
    outputs: [dashboard_render]
    publishes: []
    subscribes: [agent_status, feedback_event, indicator_data, parameter_adjustment]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  # Sprint 4 – Strategiskt minne och agentutveckling
  strategic_memory_engine:
    description: Loggar beslut, indikatorer, utfall, reward och parameterjusteringar
    inputs: [final_decision, indicator_data, execution_result, parameter_adjustment]
    outputs: [memory_insights]
    publishes: [memory_insights]
    subscribes: [final_decision, indicator_data, execution_result, parameter_adjustment]
    uses_rl: false
    receives_feedback: true
    has_adaptive_parameters: false

  meta_agent_evolution_engine:
    description: Utvärderar agentperformance och justerar logik samt meta-parametrar
    inputs: [agent_status, feedback_insight, parameter_adjustment]
    outputs: [evolution_suggestion, agent_update]
    publishes: [agent_update]
    subscribes: [agent_status, feedback_insight, parameter_adjustment]
    uses_rl: true
    receives_feedback: true
    has_adaptive_parameters: true

  agent_manager:
    description: Hanterar agentprofiler, versioner och loggar parameterhistorik
    inputs: [agent_update, parameter_adjustment]
    outputs: [agent_profile]
    publishes: [agent_profile]
    subscribes: [agent_update, parameter_adjustment]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  # Sprint 5 – Simulering och konsensus
  decision_simulator:
    description: Testar alternativa beslut i sandbox och jämför utfall
    inputs: [trade_proposal]
    outputs: [simulation_result]
    publishes: [simulation_result]
    subscribes: [trade_proposal]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  vote_engine:
    description: Genomför röstning mellan agenter och returnerar röstmatris
    inputs: [decision_vote]
    outputs: [vote_matrix]
    publishes: [vote_matrix]
    subscribes: [decision_vote]
    uses_rl: false
    receives_feedback: true
    has_adaptive_parameters: true

  consensus_engine:
    description: Väljer konsensusmodell och avgör beslutets robusthet
    inputs: [vote_matrix]
    outputs: [final_decision]
    publishes: [final_decision]
    subscribes: [vote_matrix]
    uses_rl: true
    receives_feedback: true
    has_adaptive_parameters: false

  # Sprint 6 – Tidsanalys och action chains
  timespan_tracker:
    description: Synkroniserar beslut och indikatorer över tid
    inputs: [decision_event, indicator_data]
    outputs: [timeline_insight]
    publishes: [timeline_insight]
    subscribes: [decision_event, indicator_data]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  action_chain_engine:
    description: Definierar återanvändbara beslutskedjor
    inputs: [chain_definition]
    outputs: [chain_execution]
    publishes: [chain_execution]
    subscribes: [chain_definition]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false

  # Sprint 7 – Visualisering och systemöversikt
  system_monitor:
    description: Visar systemöversikt, indikatortrender och agentrespons
    inputs: [dashboard_data]
    outputs: [system_view]
    publishes: []
    subscribes: [dashboard_data]
    uses_rl: false
    receives_feedback: false
    has_adaptive_parameters: false